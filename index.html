<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cleanup Content Calendar</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <style>
        /* [... CSS Anda yang sudah ada tetap sama, tidak perlu diubah ...] */
        /* Reset dan Base Styles */
Â  Â  Â  Â  * {
Â  Â  Â  Â  Â  Â  margin: 0;
Â  Â  Â  Â  Â  Â  padding: 0;
Â  Â  Â  Â  Â  Â  box-sizing: border-box;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  body {
Â  Â  Â  Â  Â  Â  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  min-height: 100vh;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Container */
Â  Â  Â  Â  .container {
Â  Â  Â  Â  Â  Â  max-width: 1400px;
Â  Â  Â  Â  Â  Â  margin: 0 auto;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border-radius: 20px;
Â  Â  Â  Â  Â  Â  box-shadow: 0 20px 60px rgba(0,0,0,0.3);
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Header */
Â  Â  Â  Â  .header {
Â  Â  Â  Â  Â  Â  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .header h1 {
Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Controls */
Â  Â  Â  Â  .controls {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  Â  Â  Â  justify-content: center;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  border-bottom: 2px solid #e9ecef;
Â  Â  Â  Â  }
        
        /* BARU: Styling untuk grup tombol baru */
        .controls .button-group {
            display: flex;
            gap: 10px;
            width: 100%;
            justify-content: center;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e9ecef;
        }

        .controls .button-group button {
            background: #4a5568;
        }
        .controls .button-group button:hover {
            background: #2d3748;
        }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .controls button {
Â  Â  Â  Â  Â  Â  padding: 10px 20px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  background: #667eea;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .controls button:hover {
Â  Â  Â  Â  Â  Â  background: #5a67d8;
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .controls select {
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  border: 2px solid #e9ecef;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Calendar Grid */
Â  Â  Â  Â  .calendar-container {
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .month-header {
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #2d3748;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .calendar-grid {
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(7, 1fr);
Â  Â  Â  Â  Â  Â  gap: 5px;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-header {
Â  Â  Â  Â  Â  Â  background: #667eea;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-cell {
Â  Â  Â  Â  Â  Â  min-height: 120px;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  border: 1px solid #e9ecef;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  padding: 8px;
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-cell:hover {
Â  Â  Â  Â  Â  Â  box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
Â  Â  Â  Â  Â  Â  transform: translateY(-2px);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-cell.other-month {
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  opacity: 0.5;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-cell.weekend {
Â  Â  Â  Â  Â  Â  background: #fff5f5;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-cell.today {
Â  Â  Â  Â  Â  Â  border: 2px solid #667eea;
Â  Â  Â  Â  Â  Â  background: #f0f4ff;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-number {
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  Â  Â  color: #2d3748;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .day-tasks {
Â  Â  Â  Â  Â  Â  font-size: 10px;
Â  Â  Â  Â  Â  Â  color: #4a5568;
Â  Â  Â  Â  Â  Â  max-height: 80px;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-item {
Â  Â  Â  Â  Â  Â  background: #e6f3ff;
Â  Â  Â  Â  Â  Â  padding: 2px 4px;
Â  Â  Â  Â  Â  Â  margin: 2px 0;
Â  Â  Â  Â  Â  Â  border-radius: 3px;
Â  Â  Â  Â  Â  Â  white-space: nowrap;
Â  Â  Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  Â  Â  text-overflow: ellipsis;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-item.editing {
Â  Â  Â  Â  Â  Â  background: #fff3cd;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-item.cleanup {
Â  Â  Â  Â  Â  Â  background: #d4edda;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-item.mrf {
Â  Â  Â  Â  Â  Â  background: #e7e3ff;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Task Detail Modal */
Â  Â  Â  Â  .modal {
Â  Â  Â  Â  Â  Â  display: none;
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 0;
Â  Â  Â  Â  Â  Â  left: 0;
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  height: 100%;
Â  Â  Â  Â  Â  Â  background: rgba(0,0,0,0.5);
Â  Â  Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  Â  Â  animation: fadeIn 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .modal-content {
Â  Â  Â  Â  Â  Â  position: relative;
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  margin: 5% auto;
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  width: 90%;
Â  Â  Â  Â  Â  Â  max-width: 600px;
Â  Â  Â  Â  Â  Â  border-radius: 15px;
Â  Â  Â  Â  Â  Â  max-height: 80vh;
Â  Â  Â  Â  Â  Â  overflow-y: auto;
Â  Â  Â  Â  Â  Â  animation: slideIn 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes fadeIn {
Â  Â  Â  Â  Â  Â  from { opacity: 0; }
Â  Â  Â  Â  Â  Â  to { opacity: 1; }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  @keyframes slideIn {
Â  Â  Â  Â  Â  Â  from { transform: translateY(-50px); opacity: 0; }
Â  Â  Â  Â  Â  Â  to { transform: translateY(0); opacity: 1; }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .modal-header {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  margin-bottom: 20px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .modal-header h2 {
Â  Â  Â  Â  Â  Â  color: #2d3748;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .close-btn {
Â  Â  Â  Â  Â  Â  font-size: 30px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  color: #718096;
Â  Â  Â  Â  Â  Â  transition: color 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .close-btn:hover {
Â  Â  Â  Â  Â  Â  color: #2d3748;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-list {
Â  Â  Â  Â  Â  Â  margin: 10px 0;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-list-item {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  justify-content: space-between;
Â  Â  Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  margin: 5px 0;
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  Â  Â  transition: background 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-list-item:hover {
Â  Â  Â  Â  Â  Â  background: #e9ecef;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .task-actions {
Â  Â  Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  Â  Â  gap: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-edit, .btn-delete {
Â  Â  Â  Â  Â  Â  padding: 5px 10px;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  transition: all 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-edit {
Â  Â  Â  Â  Â  Â  background: #4299e1;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-edit:hover {
Â  Â  Â  Â  Â  Â  background: #3182ce;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-delete {
Â  Â  Â  Â  Â  Â  background: #f56565;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .btn-delete:hover {
Â  Â  Â  Â  Â  Â  background: #e53e3e;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .add-task-form {
Â  Â  Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  background: #f0f4ff;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .add-task-form input, .add-task-form select {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  margin: 5px 0;
Â  Â  Â  Â  Â  Â  border: 1px solid #cbd5e0;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .add-task-form button {
Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  padding: 10px;
Â  Â  Â  Â  Â  Â  background: #48bb78;
Â  Â  Â  Â  Â  Â  color: white;
Â  Â  Â  Â  Â  Â  border: none;
Â  Â  Â  Â  Â  Â  border-radius: 5px;
Â  Â  Â  Â  Â  Â  cursor: pointer;
Â  Â  Â  Â  Â  Â  margin-top: 10px;
Â  Â  Â  Â  Â  Â  transition: background 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .add-task-form button:hover {
Â  Â  Â  Â  Â  Â  background: #38a169;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Stats Panel */
Â  Â  Â  Â  .stats-panel {
Â  Â  Â  Â  Â  Â  padding: 20px;
Â  Â  Â  Â  Â  Â  background: #f8f9fa;
Â  Â  Â  Â  Â  Â  border-top: 2px solid #e9ecef;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .stats-grid {
Â  Â  Â  Â  Â  Â  display: grid;
Â  Â  Â  Â  Â  Â  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
Â  Â  Â  Â  Â  Â  gap: 15px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .stat-card {
Â  Â  Â  Â  Â  Â  background: white;
Â  Â  Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  Â  Â  border-radius: 10px;
Â  Â  Â  Â  Â  Â  text-align: center;
Â  Â  Â  Â  Â  Â  transition: transform 0.3s;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .stat-card:hover {
Â  Â  Â  Â  Â  Â  transform: translateY(-5px);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .stat-value {
Â  Â  Â  Â  Â  Â  font-size: 24px;
Â  Â  Â  Â  Â  Â  font-weight: bold;
Â  Â  Â  Â  Â  Â  color: #667eea;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .stat-label {
Â  Â  Â  Â  Â  Â  color: #718096;
Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  margin-top: 5px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Responsive Design */
Â  Â  Â  Â  @media (max-width: 768px) {
            .controls {
Â  Â  Â  Â  Â  Â  Â  Â  flex-direction: column;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .controls button, .controls select {
Â  Â  Â  Â  Â  Â  Â  Â  width: 100%;
Â  Â  Â  Â  Â  Â  }
            /* BARU: Responsive untuk grup tombol */
            .controls .button-group {
                flex-direction: column;
            }

Â  Â  Â  Â  Â  Â  .calendar-grid {
Â  Â  Â  Â  Â  Â  Â  Â  gap: 2px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .day-cell {
Â  Â  Â  Â  Â  Â  Â  Â  min-height: 80px;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 5px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .day-header {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 10px;
Â  Â  Â  Â  Â  Â  Â  Â  padding: 5px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .day-number {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 12px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .day-tasks {
Â  Â  Â  Â  Â  Â  Â  Â  font-size: 8px;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  .modal-content {
Â  Â  Â  Â  Â  Â  Â  Â  width: 95%;
Â  Â  Â  Â  Â  Â  Â  Â  margin: 10% auto;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Loading Spinner */
Â  Â  Â  Â  .loading {
Â  Â  Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  Â  Â  top: 50%;
Â  Â  Â  Â  Â  Â  left: 50%;
Â  Â  Â  Â  Â  Â  transform: translate(-50%, -50%);
Â  Â  Â  Â  Â  Â  font-size: 20px;
Â  Â  Â  Â  Â  Â  color: #667eea;
Â  Â  Â  Â  Â  Â  display: none;
            z-index: 2000; /* BARU: pastikan di atas modal */
            background: rgba(255, 255, 255, 0.8);
            padding: 20px;
            border-radius: 10px;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .loading.show {
Â  Â  Â  Â  Â  Â  display: block;
Â  Â  Â  Â  }
    </style>
</head>
<body>
    <div class="container" id="captureArea"> <div class="header">
            <h1>ğŸ“¸ Cleanup Content Calendar</h1>
            <p>Sistem Penjadwalan Konten untuk Tim Cleanup</p>
        </div>
        
        <div class="controls">
            <button id="prevMonth">â—€ Bulan Sebelumnya</button>
            <select id="monthSelect"></select>
            <select id="yearSelect"></select>
            <button id="nextMonth">Bulan Berikutnya â–¶</button>
            <button id="generateMonth">Generate Jadwal Bulanan</button>
            <button id="generateYear">Generate Jadwal Tahunan</button>
            <button id="todayBtn">Hari Ini</button>

            <div class="button-group">
                <button id="saveToSheetsBtn">ğŸ’¾ Simpan ke Google Sheets</button>
                <button id="loadFromSheetsBtn">ğŸ”„ Muat dari Google Sheets</button>
                <button id="exportPdfBtn">ğŸ“„ Export PDF</button>
                <button id="exportImgBtn">ğŸ–¼ï¸ Export Gambar</button>
            </div>
        </div>
        
        <div class="calendar-container">
            <div class="month-header" id="monthHeader"></div>
            <div class="calendar-grid" id="calendar"></div>
        </div>
        
        <div class="stats-panel">
             <div class="stats-grid">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-value" id="totalTasks">0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-label">Total Tugas Bulan Ini</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-value" id="cleanupCount">0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-label">Cleanup Sessions</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-value" id="editingCount">0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-label">Editing Sessions</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-card">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-value" id="weekProgress">0/4</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="stat-label">Progress Minggu</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
        </div>
    </div>
    
    <div class="modal" id="taskModal">
        <div class="modal-content">
Â  Â  Â  Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  Â  Â  Â  Â  <h2 id="modalTitle">Detail Tugas</h2>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="close-btn" id="closeModal">&times;</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="task-list" id="taskList"></div>
Â  Â  Â  Â  Â  Â  <div class="add-task-form">
Â  Â  Â  Â  Â  Â  Â  Â  <h3>Tambah Tugas Baru</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="newTaskInput" placeholder="Masukkan tugas baru...">
Â  Â  Â  Â  Â  Â  Â  Â  <select id="taskCategory">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="cleanup">Cleanup</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="editing">Editing</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="mrf">MRF</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="other">Lainnya</option>
Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="teamSelect">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">Pilih Tim (opsional)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="lele">Tim Lele - Bengkong</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="walrus">Tim Walrus - Tanjung Uma</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="oyster">Tim Oyster - Setokok</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="dugong">Tim Dugong - Moving</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="jellyfish">Tim Jellyfish - Moving</option>
Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  <button id="addTaskBtn">Tambah Tugas</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
    </div>
    
    <div class="loading" id="loading">â³ Loading...</div>
    
    <script>
        // BARU: URL Web App Google Apps Script Anda akan ditaruh di sini
        const SCRIPT_URL = "MASUKKAN_URL_SCRIPT_ANDA_DI_SINI"; 

        // Data struktur untuk menyimpan jadwal
        let scheduleData = {};
        let currentMonth = new Date().getMonth();
        let currentYear = new Date().getFullYear();
        let selectedDate = null;
        
        // [ ... Sisa konstanta teams dan weeklyTemplate tetap sama ... ]
         // Teams configuration
Â  Â  Â  Â  const teams = {
Â  Â  Â  Â  Â  Â  lele: { name: "Tim Lele", location: "Bengkong" },
Â  Â  Â  Â  Â  Â  walrus: { name: "Tim Walrus", location: "Tanjung Uma" },
Â  Â  Â  Â  Â  Â  oyster: { name: "Tim Oyster", location: "Setokok" },
Â  Â  Â  Â  Â  Â  dugong: { name: "Tim Dugong", location: "Moving" },
Â  Â  Â  Â  Â  Â  jellyfish: { name: "Tim Jellyfish", location: "Moving" }
Â  Â  Â  Â  };
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Template jadwal mingguan berdasarkan dokumen
Â  Â  Â  Â  const weeklyTemplate = {
Â  Â  Â  Â  Â  Â  1: {
Â  Â  Â  Â  Â  Â  Â  Â  tasks: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "2-3 times cleanup shooting",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Cleanup footage",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "MRF footage",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Thematic timelapse",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Select 10 best raw photos & videos [cleanup, MRF]",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Provide landscape & portrait version",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Edit plastic adventure of the month + 1 requested simple video"
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  2: {
Â  Â  Â  Â  Â  Â  Â  Â  tasks: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "2-3 times cleanup shooting",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Cleanup footage with moving crew",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Thematic timelapse",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "MRF footage",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Provide landscape & portrait version",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Select 10 best raw photos & videos [cleanup, MRF]",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Edit 2-3 requested simple videos"
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  3: {
Â  Â  Â  Â  Â  Â  Â  Â  tasks: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "2-3 times cleanup shooting",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Cleanup footage",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "MRF footage",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Thematic timelapse",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Crew highlight",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Select 10 best raw photos & videos [cleanup, MRF]",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Provide landscape & portrait version",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Edit 2-3 requested simple videos"
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  4: {
Â  Â  Â  Â  Â  Â  Â  Â  tasks: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "2-3 times cleanup shooting",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Cleanup footage with moving crew",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "MRF footage",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Thematic timelapse",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Select 10 best raw photos & videos [cleanup, MRF]",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Provide landscape & portrait version",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  "Edit 2-3 requested simple videos"
Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };
        // BARU: Helper untuk loading state
        const loadingIndicator = document.getElementById('loading');
        function showLoading(message = 'Loading...') {
            loadingIndicator.textContent = `â³ ${message}`;
            loadingIndicator.classList.add('show');
        }

        function hideLoading() {
            loadingIndicator.classList.remove('show');
        }
        
        // Initialize calendar
        function init() {
            populateSelects();
            loadStoredData(); // Memuat data lokal dulu
            renderCalendar();
            setupEventListeners();
        }
        
        // Populate month and year selects
        function populateSelects() {
            // [ ... fungsi ini tetap sama ... ]
            const monthSelect = document.getElementById('monthSelect');
Â  Â  Â  Â  Â  Â  const yearSelect = document.getElementById('yearSelect');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const months = [
Â  Â  Â  Â  Â  Â  Â  Â  'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
Â  Â  Â  Â  Â  Â  Â  Â  'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
Â  Â  Â  Â  Â  Â  ];
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  months.forEach((month, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  const option = document.createElement('option');
Â  Â  Â  Â  Â  Â  Â  Â  option.value = index;
Â  Â  Â  Â  Â  Â  Â  Â  option.textContent = month;
Â  Â  Â  Â  Â  Â  Â  Â  monthSelect.appendChild(option);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  for (let year = 2024; year <= 2030; year++) {
Â  Â  Â  Â  Â  Â  Â  Â  const option = document.createElement('option');
Â  Â  Â  Â  Â  Â  Â  Â  option.value = year;
Â  Â  Â  Â  Â  Â  Â  Â  option.textContent = year;
Â  Â  Â  Â  Â  Â  Â  Â  yearSelect.appendChild(option);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  monthSelect.value = currentMonth;
Â  Â  Â  Â  Â  Â  yearSelect.value = currentYear;
        }
        
        // Load stored data from localStorage
        function loadStoredData() {
            const stored = localStorage.getItem('scheduleData');
            if (stored) {
                scheduleData = JSON.parse(stored);
            }
        }
        
        // Save data to localStorage
        function saveData() {
            localStorage.setItem('scheduleData', JSON.stringify(scheduleData));
        }
        
        // [ ... Sisa fungsi inti seperti getDateKey, renderCalendar, createDayCell, openTaskModal, addTask, editTask, deleteTask, generateMonthlySchedule, generateYearlySchedule, updateStats tetap sama ... ]
        // Generate unique key for date
Â  Â  Â  Â  function getDateKey(year, month, day) {
Â  Â  Â  Â  Â  Â  return `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Render calendar grid
Â  Â  Â  Â  function renderCalendar() {
Â  Â  Â  Â  Â  Â  const calendar = document.getElementById('calendar');
Â  Â  Â  Â  Â  Â  const monthHeader = document.getElementById('monthHeader');
Â  Â  Â  Â  Â  Â  const monthNames = [
Â  Â  Â  Â  Â  Â  Â  Â  'Januari', 'Februari', 'Maret', 'April', 'Mei', 'Juni',
Â  Â  Â  Â  Â  Â  Â  Â  'Juli', 'Agustus', 'September', 'Oktober', 'November', 'Desember'
Â  Â  Â  Â  Â  Â  ];
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  monthHeader.textContent = `${monthNames[currentMonth]} ${currentYear}`;
Â  Â  Â  Â  Â  Â  calendar.innerHTML = '';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Add day headers
Â  Â  Â  Â  Â  Â  const dayHeaders = ['Min', 'Sen', 'Sel', 'Rab', 'Kam', 'Jum', 'Sab'];
Â  Â  Â  Â  Â  Â  dayHeaders.forEach(day => {
Â  Â  Â  Â  Â  Â  Â  Â  const dayHeader = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  dayHeader.className = 'day-header';
Â  Â  Â  Â  Â  Â  Â  Â  dayHeader.textContent = day;
Â  Â  Â  Â  Â  Â  Â  Â  calendar.appendChild(dayHeader);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Calculate days in month
Â  Â  Â  Â  Â  Â  const firstDay = new Date(currentYear, currentMonth, 1);
Â  Â  Â  Â  Â  Â  const lastDay = new Date(currentYear, currentMonth + 1, 0);
Â  Â  Â  Â  Â  Â  const prevLastDay = new Date(currentYear, currentMonth, 0);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const startDay = firstDay.getDay();
Â  Â  Â  Â  Â  Â  const daysInMonth = lastDay.getDate();
Â  Â  Â  Â  Â  Â  const daysInPrevMonth = prevLastDay.getDate();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Add previous month days
Â  Â  Â  Â  Â  Â  for (let i = startDay - 1; i >= 0; i--) {
Â  Â  Â  Â  Â  Â  Â  Â  const dayCell = createDayCell(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  daysInPrevMonth - i,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentMonth - 1,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentYear,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  true
Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  calendar.appendChild(dayCell);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Add current month days
Â  Â  Â  Â  Â  Â  for (let day = 1; day <= daysInMonth; day++) {
Â  Â  Â  Â  Â  Â  Â  Â  const dayCell = createDayCell(day, currentMonth, currentYear, false);
Â  Â  Â  Â  Â  Â  Â  Â  calendar.appendChild(dayCell);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Add next month days
Â  Â  Â  Â  Â  Â  const totalCells = calendar.children.length - 7; // Subtract headers
            const requiredRows = Math.ceil(totalCells / 7);
            const requiredCells = requiredRows * 7;
Â  Â  Â  Â  Â  Â  const remainingCells = requiredCells - totalCells;
Â  Â  Â  Â  Â  Â  for (let day = 1; day <= remainingCells; day++) {
Â  Â  Â  Â  Â  Â  Â  Â  const dayCell = createDayCell(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  day,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentMonth + 1,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentYear,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  true
Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  calendar.appendChild(dayCell);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateStats();
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Create day cell element
Â  Â  Â  Â  function createDayCell(day, month, year, isOtherMonth) {
Â  Â  Â  Â  Â  Â  const dayCell = document.createElement('div');
Â  Â  Â  Â  Â  Â  dayCell.className = 'day-cell';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (isOtherMonth) {
Â  Â  Â  Â  Â  Â  Â  Â  dayCell.classList.add('other-month');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const actualMonth = month < 0 ? 11 : month > 11 ? 0 : month;
Â  Â  Â  Â  Â  Â  const actualYear = month < 0 ? year - 1 : month > 11 ? year + 1 : year;
Â  Â  Â  Â  Â  Â  const dayOfWeek = new Date(actualYear, actualMonth, day).getDay();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Mark weekends
Â  Â  Â  Â  Â  Â  if (dayOfWeek === 0 || dayOfWeek === 6) {
Â  Â  Â  Â  Â  Â  Â  Â  dayCell.classList.add('weekend');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Mark today
Â  Â  Â  Â  Â  Â  const today = new Date();
Â  Â  Â  Â  Â  Â  if (
Â  Â  Â  Â  Â  Â  Â  Â  day === today.getDate() &&
Â  Â  Â  Â  Â  Â  Â  Â  actualMonth === today.getMonth() &&
Â  Â  Â  Â  Â  Â  Â  Â  actualYear === today.getFullYear()
Â  Â  Â  Â  Â  Â  ) {
Â  Â  Â  Â  Â  Â  Â  Â  dayCell.classList.add('today');
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Day number
Â  Â  Â  Â  Â  Â  const dayNumber = document.createElement('div');
Â  Â  Â  Â  Â  Â  dayNumber.className = 'day-number';
Â  Â  Â  Â  Â  Â  dayNumber.textContent = day;
Â  Â  Â  Â  Â  Â  dayCell.appendChild(dayNumber);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Tasks container
Â  Â  Â  Â  Â  Â  const dayTasks = document.createElement('div');
Â  Â  Â  Â  Â  Â  dayTasks.className = 'day-tasks';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Load tasks for this day
Â  Â  Â  Â  Â  Â  const dateKey = getDateKey(actualYear, actualMonth, day);
Â  Â  Â  Â  Â  Â  if (scheduleData[dateKey]) {
Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].forEach(task => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const taskItem = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskItem.className = `task-item ${task.category || 'other'}`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskItem.textContent = task.text;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dayTasks.appendChild(taskItem);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  dayCell.appendChild(dayTasks);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Add click handler
Â  Â  Â  Â  Â  Â  dayCell.addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  openTaskModal(actualYear, actualMonth, day);
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  return dayCell;
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Open task modal
Â  Â  Â  Â  function openTaskModal(year, month, day) {
Â  Â  Â  Â  Â  Â  const modal = document.getElementById('taskModal');
Â  Â  Â  Â  Â  Â  const modalTitle = document.getElementById('modalTitle');
Â  Â  Â  Â  Â  Â  const taskList = document.getElementById('taskList');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  selectedDate = { year, month, day };
Â  Â  Â  Â  Â  Â  const dateKey = getDateKey(year, month, day);
Â  Â  Â  Â  Â  Â  const dayOfWeek = new Date(year, month, day).getDay();
Â  Â  Â  Â  Â  Â  const dayNames = ['Minggu', 'Senin', 'Selasa', 'Rabu', 'Kamis', 'Jumat', 'Sabtu'];
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  modalTitle.textContent = `${dayNames[dayOfWeek]}, ${day}/${month + 1}/${year}`;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Display existing tasks
Â  Â  Â  Â  Â  Â  taskList.innerHTML = '';
Â  Â  Â  Â  Â  Â  if (scheduleData[dateKey]) {
Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].forEach((task, index) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const taskItem = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskItem.className = 'task-list-item';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const taskText = document.createElement('span');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskText.textContent = task.text;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (task.team) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskText.textContent += ` (${teams[task.team].name})`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const taskActions = document.createElement('div');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskActions.className = 'task-actions';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const editBtn = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  editBtn.className = 'btn-edit';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  editBtn.textContent = 'Edit';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  editBtn.onclick = () => editTask(dateKey, index);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const deleteBtn = document.createElement('button');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deleteBtn.className = 'btn-delete';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deleteBtn.textContent = 'Hapus';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  deleteBtn.onclick = () => deleteTask(dateKey, index);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskActions.appendChild(editBtn);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskActions.appendChild(deleteBtn);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskItem.appendChild(taskText);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskItem.appendChild(taskActions);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  taskList.appendChild(taskItem);
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  taskList.innerHTML = '<p style="color: #718096; text-align: center;">Belum ada tugas untuk hari ini</p>';
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  modal.style.display = 'block';
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Add new task
Â  Â  Â  Â  function addTask() {
Â  Â  Â  Â  Â  Â  const input = document.getElementById('newTaskInput');
Â  Â  Â  Â  Â  Â  const category = document.getElementById('taskCategory').value;
Â  Â  Â  Â  Â  Â  const team = document.getElementById('teamSelect').value;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!input.value.trim()) {
Â  Â  Â  Â  Â  Â  Â  Â  alert('Silakan masukkan tugas');
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!selectedDate) return;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const dateKey = getDateKey(selectedDate.year, selectedDate.month, selectedDate.day);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!scheduleData[dateKey]) {
Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey] = [];
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const taskData = {
Â  Â  Â  Â  Â  Â  Â  Â  text: input.value.trim(),
Â  Â  Â  Â  Â  Â  Â  Â  category: category
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (team) {
Â  Â  Â  Â  Â  Â  Â  Â  taskData.team = team;
Â  _Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push(taskData);
Â  Â  Â  Â  Â  Â  saveData();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  input.value = '';
Â  Â  Â  Â  Â  Â  document.getElementById('teamSelect').value = '';
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  openTaskModal(selectedDate.year, selectedDate.month, selectedDate.day);
Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Edit task
Â  Â  Â  Â  function editTask(dateKey, index) {
Â  Â  Â  Â  Â  Â  const task = scheduleData[dateKey][index];
Â  Â  Â  Â  Â  Â  const newText = prompt('Edit tugas:', task.text);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (newText !== null && newText.trim()) {
Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey][index].text = newText.trim();
Â  Â  Â  Â  Â  Â  Â  Â  saveData();
Â  Â  Â  Â  Â  Â  Â  Â  openTaskModal(selectedDate.year, selectedDate.month, selectedDate.day);
Â  Â  Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Delete task
Â  Â  Â  Â  function deleteTask(dateKey, index) {
Â  Â  Â  Â  Â  Â  if (confirm('Apakah Anda yakin ingin menghapus tugas ini?')) {
Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].splice(index, 1);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  if (scheduleData[dateKey].length === 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  delete scheduleData[dateKey];
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  saveData();
Â  Â  Â  Â  Â  Â  Â  Â  openTaskModal(selectedDate.year, selectedDate.month, selectedDate.day);
Â  Â  Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Generate monthly schedule
Â  Â  Â  Â  function generateMonthlySchedule() {
Â  Â  Â  Â  Â  Â  if (!confirm('Generate jadwal bulanan akan mengganti jadwal yang ada. Lanjutkan?')) {
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  showLoading('Generating monthly schedule...');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Clear existing schedule for the month
Â  Â  Â  Â  Â  Â  const year = currentYear;
Â  Â  Â  Â  Â  Â  const month = currentMonth;
Â  Â  Â  Â  Â  Â  const daysInMonth = new Date(year, month + 1, 0).getDate();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Clear month data
Â  Â  Â  Â  Â  Â  for (let day = 1; day <= daysInMonth; day++) {
Â  Â  Â  Â  Â  Â  Â  Â  const dateKey = getDateKey(year, month, day);
Â  Â  Â  Â  Â  Â  Â  Â  delete scheduleData[dateKey];
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Determine team rotation for Monday and Wednesday
Â  Â  Â  Â  Â  Â  const teamRotation = ['lele', 'walrus', 'oyster', 'dugong', 'jellyfish'];
Â  Â  Â  Â  Â  Â  let teamIndex = 0;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Generate schedule
Â  Â  Â  Â  Â  Â  for (let day = 1; day <= daysInMonth; day++) {
Â  Â  Â  Â  Â  Â  Â  Â  const date = new Date(year, month, day);
Â  Â  Â  Â  Â  Â  Â  Â  const dayOfWeek = date.getDay();
Â  Â  Â  Â  Â  Â  Â  Â  const weekOfMonth = Math.ceil((day + new Date(year, month, 1).getDay()) / 7);
Â  Â  Â  Â  Â  Â  Â  Â  const dateKey = getDateKey(year, month, day);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Skip weekends
Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 0 || dayOfWeek === 6) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey] = [];
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Friday is always editing day
Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 5) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Editing Day - Edit requested videos", category: "editing" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Select & organize weekly best shots", category: "editing" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Prepare landscape & portrait versions", category: "editing" }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Add week-specific editing tasks
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (weekOfMonth === 1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "Edit plastic adventure of the month",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "editing"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Get week template
Â  Â  Â  Â  Â  Â  Â  Â  const weekTemplate = weeklyTemplate[weekOfMonth] || weeklyTemplate[4];
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Monday (1) and Wednesday (3) - assign teams
Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 1 || dayOfWeek === 3) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const assignedTeam = teamRotation[teamIndex % teamRotation.length];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  teamIndex++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: `Cleanup shooting - ${teams[assignedTeam].name} @ ${teams[assignedTeam].location}`,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "cleanup",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  team: assignedTeam
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Special case for Bengkong on Tuesday/Thursday
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (assignedTeam === 'lele' && (dayOfWeek === 2 || dayOfWeek === 4)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "River barrier check (usually full)",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "cleanup",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  team: "lele"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Tuesday (2) and Thursday (4) - general tasks
Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 2 || dayOfWeek === 4) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "MRF footage & documentation", category: "mrf" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Thematic timelapse shooting", category: "cleanup" }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // River barrier check for Bengkong
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 2 || dayOfWeek === 4) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "Bengkong river barrier check",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "cleanup"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Add week-specific tasks
Â  Â  Â  Â  Â  Â  Â  Â  if (weekOfMonth === 3 && dayOfWeek === 3) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "Crew highlight interview/profile",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "other"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Moving crew activities (Week 2 and 4)
Â  Â  Â  Â  Â  Â  Â  Â  if ((weekOfMonth === 2 || weekOfMonth === 4) && dayOfWeek === 2) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "Cleanup footage with moving crew",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "cleanup",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  team: "dugong"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  saveData();
Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  hideLoading();
Â  Â  Â  Â  Â  Â  Â  Â  alert('Jadwal bulanan berhasil di-generate!');
Â  Â  Â  Â  Â  Â  }, 500);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Generate yearly schedule
Â  Â  Â  Â  function generateYearlySchedule() {
Â  Â  Â  Â  Â  Â  if (!confirm('Generate jadwal tahunan akan mengganti SEMUA jadwal yang ada untuk tahun ini. Lanjutkan?')) {
Â  Â  Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  showLoading('Generating yearly schedule...');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Save current month
Â  Â  Â  Â  Â  Â  const savedMonth = currentMonth;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Generate for all 12 months
Â  Â  Â  Â  Â  Â  for (let month = 0; month < 12; month++) {
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = month;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Generate monthly schedule for each month
Â  Â  Â  Â  Â  Â  Â  Â  const year = currentYear;
Â  Â  Â  Â  Â  Â  Â  Â  const daysInMonth = new Date(year, month + 1, 0).getDate();
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  // Team rotation continues across months
Â  Â  Â  Â  Â  Â  Â  Â  const teamRotation = ['lele', 'walrus', 'oyster', 'dugong', 'jellyfish'];
Â  Â  Â  Â  Â  Â  Â  Â  let teamIndex = month * 8; // Approximate team rotations per month
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  for (let day = 1; day <= daysInMonth; day++) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const date = new Date(year, month, day);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dayOfWeek = date.getDay();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const weekOfMonth = Math.ceil((day + new Date(year, month, 1).getDay()) / 7);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const dateKey = getDateKey(year, month, day);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Skip weekends
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 0 || dayOfWeek === 6) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  continue;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey] = [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Apply same logic as monthly generation
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 5) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Friday editing
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Editing Day - Edit requested videos", category: "editing" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Select & organize weekly best shots", category: "editing" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Prepare landscape & portrait versions", category: "editing" }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (weekOfMonth === 1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "Edit plastic adventure of the month",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "editing"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (dayOfWeek === 1 || dayOfWeek === 3) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Monday/Wednesday team assignments
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const assignedTeam = teamRotation[teamIndex % teamRotation.length];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  teamIndex++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: `Cleanup shooting - ${teams[assignedTeam].name} @ ${teams[assignedTeam].location}`,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "cleanup",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  team: assignedTeam
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else if (dayOfWeek === 2 || dayOfWeek === 4) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Tuesday/Thursday tasks
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push(
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "MRF footage & documentation", category: "mrf" },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { text: "Thematic timelapse shooting", category: "cleanup" }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (dayOfWeek === 2 || dayOfWeek === 4) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "Bengkong river barrier check",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "cleanup"
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Special monthly tasks
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (day === 1) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  text: "Monthly summary video preparation",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: "editing"
Â  Â  _Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Restore current month
Â  Â  Â  Â  Â  Â  currentMonth = savedMonth;
Â  Â  Â  Â  Â  Â  saveData();
Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  Â  Â  Â  hideLoading();
Â  Â  Â  Â  Â  Â  Â  Â  alert('Jadwal tahunan berhasil di-generate!');
Â  Â  Â  Â  Â  Â  }, 1000);
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Update statistics
Â  Â  Â  Â  function updateStats() {
Â  Â  Â  Â  Â  Â  const year = currentYear;
Â  Â  Â  Â  Â  Â  const month = currentMonth;
Â  Â  Â  Â  Â  Â  const daysInMonth = new Date(year, month + 1, 0).getDate();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  let totalTasks = 0;
Â  Â  Â  Â  Â  Â  let cleanupCount = 0;
Â  Â  Â  Â  Â  Â  let editingCount = 0;
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  for (let day = 1; day <= daysInMonth; day++) {
Â  Â  Â  Â  Â  Â  Â  Â  const dateKey = getDateKey(year, month, day);
Â  Â  Â  Â  Â  Â  Â  Â  if (scheduleData[dateKey]) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  totalTasks += scheduleData[dateKey].length;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scheduleData[dateKey].forEach(task => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (task.category === 'cleanup') cleanupCount++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (task.category === 'editing') editingCount++;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Calculate week progress
Â  Â  Â  Â  Â  Â  const today = new Date();
Â  Â  Â  Â  Â  Â  let weekProgress = 0;
Â  Â  Â  Â  Â  Â  if (today.getMonth() === month && today.getFullYear() === year) {
Â  Â  Â  Â  Â  Â  Â  Â  weekProgress = Math.ceil((today.getDate() + new Date(year, month, 1).getDay()) / 7);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('totalTasks').textContent = totalTasks;
Â  Â  Â  Â  Â  Â  document.getElementById('cleanupCount').textContent = cleanupCount;
Â  Â  Â  Â  Â  Â  document.getElementById('editingCount').textContent = editingCount;
Â  Â  Â  Â  Â  Â  document.getElementById('weekProgress').textContent = `${weekProgress}/4`;
Â  Â  Â  Â  }

        // --- BARU: FUNGSI UNTUK GOOGLE SHEETS & EXPORT ---

        // Fungsi Simpan ke Google Sheets
        function saveToGoogleSheets() {
            if (SCRIPT_URL === "MASUKKAN_URL_SCRIPT_ANDA_DI_SINI") {
                alert("Harap masukkan URL Apps Script Anda di dalam kode JavaScript terlebih dahulu.");
                return;
            }
            showLoading('Menyimpan ke Google Sheets...');
            fetch(SCRIPT_URL, {
                method: 'POST',
                body: JSON.stringify(scheduleData)
            })
            .then(res => res.json())
            .then(data => {
                hideLoading();
                alert(data.message);
            })
            .catch(error => {
                hideLoading();
                alert('Gagal menyimpan data. Cek konsol untuk detail.');
                console.error('Error saving to Google Sheets:', error);
            });
        }

        // Fungsi Muat dari Google Sheets
        function loadFromGoogleSheets() {
            if (SCRIPT_URL === "MASUKKAN_URL_SCRIPT_ANDA_DI_SINI") {
                alert("Harap masukkan URL Apps Script Anda di dalam kode JavaScript terlebih dahulu.");
                return;
            }
            showLoading('Memuat dari Google Sheets...');
            fetch(SCRIPT_URL)
            .then(res => res.json())
            .then(data => {
                if (Object.keys(data).length > 0) {
                    scheduleData = data;
                    saveData(); // Simpan juga ke lokal
                    renderCalendar();
                    alert('Data berhasil dimuat dari Google Sheets!');
                } else {
                    alert('Tidak ada data yang tersimpan di Google Sheets.');
                }
                hideLoading();
            })
            .catch(error => {
                hideLoading();
                alert('Gagal memuat data. Cek konsol untuk detail.');
                console.error('Error loading from Google Sheets:', error);
            });
        }

        // Fungsi Export ke PDF
        function exportToPDF() {
            showLoading('Membuat PDF...');
            const { jsPDF } = window.jspdf;
            const content = document.getElementById('captureArea');
            
            html2canvas(content, { scale: 2 }).then(canvas => {
                const imgData = canvas.toDataURL('image/jpeg', 1.0);
                const pdf = new jsPDF({
                    orientation: 'landscape',
                    unit: 'pt',
                    format: [canvas.width, canvas.height]
                });
                
                pdf.addImage(imgData, 'JPEG', 0, 0, canvas.width, canvas.height);
                pdf.save(`kalender-konten-${currentYear}-${currentMonth + 1}.pdf`);
                hideLoading();
            });
        }

        // Fungsi Export ke Gambar (PNG)
        function exportToImage() {
            showLoading('Membuat Gambar...');
            const content = document.getElementById('captureArea');

            html2canvas(content, { scale: 2 }).then(canvas => {
                const link = document.createElement('a');
                link.download = `kalender-konten-${currentYear}-${currentMonth + 1}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                hideLoading();
            });
        }

        // ---------------------------------------------------

        // Setup event listeners
        function setupEventListeners() {
            // [ ... event listener lama tetap sama ... ]
            // Month navigation
Â  Â  Â  Â  Â  Â  document.getElementById('prevMonth').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth--;
Â  Â  Â  Â  Â  Â  Â  Â  if (currentMonth < 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = 11;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentYear--;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('monthSelect').value = currentMonth;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('yearSelect').value = currentYear;
Â  Â  Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('nextMonth').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth++;
Â  Â  Â  Â  Â  Â  Â  Â  if (currentMonth > 11) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = 0;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  currentYear++;
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('monthSelect').value = currentMonth;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('yearSelect').value = currentYear;
Â  Â  Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Month/Year selects
Â  Â  Â  Â  Â  Â  document.getElementById('monthSelect').addEventListener('change', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = parseInt(e.target.value);
Â  Â  Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('yearSelect').addEventListener('change', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  currentYear = parseInt(e.target.value);
Â  Â  Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Today button
Â  Â  Â  Â  Â  Â  document.getElementById('todayBtn').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  const today = new Date();
Â  Â  Â  Â  Â  Â  Â  Â  currentMonth = today.getMonth();
Â  Â  Â  Â  Â  Â  Â  Â  currentYear = today.getFullYear();
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('monthSelect').value = currentMonth;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('yearSelect').value = currentYear;
Â  Â  Â  Â  Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Generate buttons
Â  Â  Â  Â  Â  Â  document.getElementById('generateMonth').addEventListener('click', generateMonthlySchedule);
Â  Â  Â  Â  Â  Â  document.getElementById('generateYear').addEventListener('click', generateYearlySchedule);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Modal controls
Â  Â  Â  Â  Â  Â  document.getElementById('closeModal').addEventListener('click', () => {
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('taskModal').style.display = 'none';
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('addTaskBtn').addEventListener('click', addTask);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Close modal on outside click
Â  Â  Â  Â  Â  Â  window.addEventListener('click', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  const modal = document.getElementById('taskModal');
Â  Â  Â  Â  Â  Â  Â  Â  if (e.target === modal) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  modal.style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // Enter key for adding task
Â  Â  Â  Â  Â  Â  document.getElementById('newTaskInput').addEventListener('keypress', (e) => {
Â  Â  Â  Â  Â  Â  Â  Â  if (e.key === 'Enter') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addTask();
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });

            // BARU: Event listener untuk tombol-tombol baru
            document.getElementById('saveToSheetsBtn').addEventListener('click', saveToGoogleSheets);
            document.getElementById('loadFromSheetsBtn').addEventListener('click', loadFromGoogleSheets);
            document.getElementById('exportPdfBtn').addEventListener('click', exportToPDF);
            document.getElementById('exportImgBtn').addEventListener('click', exportToImage);
        }
        
        // Initialize on load
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>